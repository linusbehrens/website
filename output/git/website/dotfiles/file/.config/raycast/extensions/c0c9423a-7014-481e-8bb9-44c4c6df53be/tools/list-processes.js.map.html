<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>list-processes.js.map - dotfiles - Unnamed repository; edit this file &#39;description&#39; to name the repository.
</title>
<link rel="icon" type="image/png" href="../../../../../../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="dotfiles Atom Feed" href="../../../../../../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="dotfiles Atom Feed (tags)" href="../../../../../../tags.xml" />
<link rel="stylesheet" type="text/css" href="../../../../../../style.css" />
</head>
<body>
<table><tr><td><a href="../../../../../../../"><img src="../../../../../../logo.png" alt="" width="32" height="32" /></a></td><td><h1>dotfiles</h1><span class="desc">Unnamed repository; edit this file &#39;description&#39; to name the repository.
</span></td></tr><tr><td></td><td>
<a href="../../../../../../log.html">Log</a> | <a href="../../../../../../files.html">Files</a> | <a href="../../../../../../refs.html">Refs</a> | <a href="../../../../../../file/README.md.html">README</a></td></tr></table>
<hr/>
<div id="content">
<p> list-processes.js.map (6236B)</p><hr/><pre id="blob">
<a href="#l1" class="line" id="l1">      1</a> {
<a href="#l2" class="line" id="l2">      2</a>   &quot;version&quot;: 3,
<a href="#l3" class="line" id="l3">      3</a>   &quot;sources&quot;: [&quot;../../src/tools/list-processes.ts&quot;, &quot;../../src/utils/process.ts&quot;],
<a href="#l4" class="line" id="l4">      4</a>   &quot;sourcesContent&quot;: [&quot;import { Process } from \&quot;../types\&quot;;\nimport { fetchRunningProcesses } from \&quot;../utils/process\&quot;;\n\ntype SortOrder = \&quot;asc\&quot; | \&quot;desc\&quot;;\ntype SortField = keyof Process;\n\ntype Input = {\n  /**\n   * Optional array of search terms to filter processes.\n   * For single process search, provide an array with one element.\n   * Example: [\&quot;Logi\&quot;] will find all processes containing \&quot;Logi\&quot; in their name\n   * Example: [\&quot;Chrome\&quot;, \&quot;Firefox\&quot;] will find all processes containing either \&quot;Chrome\&quot; or \&quot;Firefox\&quot;\n   */\n  searchTerm?: string[];\n  /**\n   * Field to sort by (defaults to &#39;mem&#39;)\n   */\n  sortBy?: SortField;\n  /**\n   * Sort order (defaults to &#39;desc&#39;)\n   */\n  sortOrder?: SortOrder;\n};\n\nconst sortProcesses = (processes: Process[], field: SortField = \&quot;mem\&quot;, order: SortOrder = \&quot;desc\&quot;): Process[] =&gt; {\n  return [...processes].sort((a, b) =&gt; {\n    const valueA = a[field];\n    const valueB = b[field];\n\n    if (valueA === valueB) return 0;\n    if (valueA === undefined) return 1;\n    if (valueB === undefined) return -1;\n\n    const comparison = valueA &lt; valueB ? -1 : 1;\n    return order === \&quot;desc\&quot; ? -comparison : comparison;\n  });\n};\n\nconst filterProcessesBySearchTerm = (processes: Process[], searchTerms?: string[]): Process[] =&gt; {\n  if (!searchTerms?.length) return processes;\n\n  return processes.filter((p) =&gt; {\n    const searchIn = `${p.path} ${p.processName} ${p.appName || \&quot;\&quot;}`.toLowerCase();\n    return searchTerms.some((term) =&gt; searchIn.includes(term.toLowerCase()));\n  });\n};\n\nconst validateResults = (processes: Process[], searchTerms?: string[]): void =&gt; {\n  if (processes.length === 0 &amp;&amp; searchTerms?.length) {\n    throw new Error(`No processes found matching \&quot;${searchTerms.join(\&quot;, \&quot;)}\&quot;`);\n  }\n};\n\n/**\n * List out all running processes.\n * This tool can be called by AI to answer queries like,\n * \&quot;What processes are running right now?\&quot;\n * or \&quot;list processes containing xyz\&quot;\n * or \&quot;list processes containing xyz and abc\&quot;\n *\n * Throws an error if no processes are found matching the search terms\n */\nexport default async function listProcesses(input?: Input): Promise&lt;Process[]&gt; {\n  const processes = await fetchRunningProcesses();\n\n  const filteredProcesses = filterProcessesBySearchTerm(processes, input?.searchTerm);\n  validateResults(filteredProcesses, input?.searchTerm);\n\n  return sortProcesses(filteredProcesses, input?.sortBy, input?.sortOrder);\n}\n&quot;, &quot;import { exec } from \&quot;child_process\&quot;;\nimport { Process } from \&quot;../types\&quot;;\n\n/**\n * Get all processes from the system\n * @returns Promise&lt;Process[]&gt; List of processes\n */\nexport async function fetchRunningProcesses(): Promise&lt;Process[]&gt; {\n  return new Promise((resolve, reject) =&gt; {\n    exec(`ps -eo pid,ppid,pcpu,rss,comm`, (err, stdout) =&gt; {\n      if (err != null) {\n        reject(err);\n        return;\n      }\n\n      const processes = stdout\n        .split(\&quot;\\n\&quot;)\n        .map((line) =&gt; {\n          const defaultValue = [\&quot;\&quot;, \&quot;\&quot;, \&quot;\&quot;, \&quot;\&quot;, \&quot;\&quot;, \&quot;\&quot;];\n          const regex = /(\\d+)\\s+(\\d+)\\s+(\\d+[.|,]\\d+)\\s+(\\d+)\\s+(.*)/;\n          const [, id, pid, cpu, mem, path] = line.match(regex) ?? defaultValue;\n          const processName = path.match(/[^/]*[^/]*$/i)?.[0] ?? \&quot;\&quot;;\n          const isPrefPane = path.includes(\&quot;.prefPane\&quot;);\n          const isApp = path.includes(\&quot;.app/\&quot;);\n\n          return {\n            id: parseInt(id),\n            pid: parseInt(pid),\n            cpu: parseFloat(cpu),\n            mem: parseInt(mem),\n            type: isPrefPane ? \&quot;prefPane\&quot; : isApp ? \&quot;app\&quot; : \&quot;binary\&quot;,\n            path,\n            processName,\n            appName: isApp ? path.match(/(?&lt;=\\/)[^/]+(?=\\.app\\/)/)?.[0] : undefined,\n          } as Process;\n        })\n        .filter((process) =&gt; process.processName !== \&quot;\&quot;);\n      resolve(processes);\n    });\n  });\n}\n&quot;],
<a href="#l5" class="line" id="l5">      5</a>   &quot;mappings&quot;: &quot;yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,aAAAE,IAAA,eAAAC,EAAAH,GCAA,IAAAI,EAAqB,yBAOrB,eAAsBC,GAA4C,CAChE,OAAO,IAAI,QAAQ,CAACC,EAASC,IAAW,IACtC,QAAK,gCAAiC,CAACC,EAAKC,IAAW,CACrD,GAAID,GAAO,KAAM,CACfD,EAAOC,CAAG,EACV,MACF,CAEA,IAAME,EAAYD,EACf,MAAM;AAAA,CAAI,EACV,IAAKE,GAAS,CACb,IAAMC,EAAe,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,EAAE,EACtCC,EAAQ,+CACR,CAAC,CAAEC,EAAIC,EAAKC,EAAKC,EAAKC,CAAI,EAAIP,EAAK,MAAME,CAAK,GAAKD,EACnDO,EAAcD,EAAK,MAAM,cAAc,IAAI,CAAC,GAAK,GACjDE,EAAaF,EAAK,SAAS,WAAW,EACtCG,EAAQH,EAAK,SAAS,OAAO,EAEnC,MAAO,CACL,GAAI,SAASJ,CAAE,EACf,IAAK,SAASC,CAAG,EACjB,IAAK,WAAWC,CAAG,EACnB,IAAK,SAASC,CAAG,EACjB,KAAMG,EAAa,WAAaC,EAAQ,MAAQ,SAChD,KAAAH,EACA,YAAAC,EACA,QAASE,EAAQH,EAAK,MAAM,yBAAyB,IAAI,CAAC,EAAI,MAChE,CACF,CAAC,EACA,OAAQI,GAAYA,EAAQ,cAAgB,EAAE,EACjDhB,EAAQI,CAAS,CACnB,CAAC,CACH,CAAC,CACH,CDhBA,IAAMa,EAAgB,CAACC,EAAsBC,EAAmB,MAAOC,EAAmB,SACjF,CAAC,GAAGF,CAAS,EAAE,KAAK,CAACG,EAAGC,IAAM,CACnC,IAAMC,EAASF,EAAEF,CAAK,EAChBK,EAASF,EAAEH,CAAK,EAEtB,GAAII,IAAWC,EAAQ,MAAO,GAC9B,GAAID,IAAW,OAAW,MAAO,GACjC,GAAIC,IAAW,OAAW,MAAO,GAEjC,IAAMC,EAAaF,EAASC,EAAS,GAAK,EAC1C,OAAOJ,IAAU,OAAS,CAACK,EAAaA,CAC1C,CAAC,EAGGC,EAA8B,CAACR,EAAsBS,IACpDA,GAAa,OAEXT,EAAU,OAAQU,GAAM,CAC7B,IAAMC,EAAW,GAAGD,EAAE,IAAI,IAAIA,EAAE,WAAW,IAAIA,EAAE,SAAW,EAAE,GAAG,YAAY,EAC7E,OAAOD,EAAY,KAAMG,GAASD,EAAS,SAASC,EAAK,YAAY,CAAC,CAAC,CACzE,CAAC,EALgCZ,EAQ7Ba,EAAkB,CAACb,EAAsBS,IAAiC,CAC9E,GAAIT,EAAU,SAAW,GAAKS,GAAa,OACzC,MAAM,IAAI,MAAM,gCAAgCA,EAAY,KAAK,IAAI,CAAC,GAAG,CAE7E,EAWA,eAAOK,EAAqCC,EAAmC,CAC7E,IAAMf,EAAY,MAAMgB,EAAsB,EAExCC,EAAoBT,EAA4BR,EAAWe,GAAO,UAAU,EAClF,OAAAF,EAAgBI,EAAmBF,GAAO,UAAU,EAE7ChB,EAAckB,EAAmBF,GAAO,OAAQA,GAAO,SAAS,CACzE&quot;,
<a href="#l6" class="line" id="l6">      6</a>   &quot;names&quot;: [&quot;list_processes_exports&quot;, &quot;__export&quot;, &quot;listProcesses&quot;, &quot;__toCommonJS&quot;, &quot;import_child_process&quot;, &quot;fetchRunningProcesses&quot;, &quot;resolve&quot;, &quot;reject&quot;, &quot;err&quot;, &quot;stdout&quot;, &quot;processes&quot;, &quot;line&quot;, &quot;defaultValue&quot;, &quot;regex&quot;, &quot;id&quot;, &quot;pid&quot;, &quot;cpu&quot;, &quot;mem&quot;, &quot;path&quot;, &quot;processName&quot;, &quot;isPrefPane&quot;, &quot;isApp&quot;, &quot;process&quot;, &quot;sortProcesses&quot;, &quot;processes&quot;, &quot;field&quot;, &quot;order&quot;, &quot;a&quot;, &quot;b&quot;, &quot;valueA&quot;, &quot;valueB&quot;, &quot;comparison&quot;, &quot;filterProcessesBySearchTerm&quot;, &quot;searchTerms&quot;, &quot;p&quot;, &quot;searchIn&quot;, &quot;term&quot;, &quot;validateResults&quot;, &quot;listProcesses&quot;, &quot;input&quot;, &quot;fetchRunningProcesses&quot;, &quot;filteredProcesses&quot;]
<a href="#l7" class="line" id="l7">      7</a> }
</pre>
</div>
</body>
</html>
